---
aside: right
outline: [2, 3]
---

<h1 style="text-align: center; font-weight: bold;">å‡†å¤‡å·¥ä½œ</h1>

---

## é¡¹ç›®ç»“æ„

<img src="./å‡†å¤‡å·¥ä½œé¡¹ç›®ç»“æ„.png" style="width:400px;margin:0px auto"/>

#### å¼•å…¥å¤–éƒ¨åº“

> #### è·å– <span style="color:red">mysql-connector-java-5.1.37-bin.jarã€druid-1.1.10ã€commons-dbutils-1.3ã€Utility å·¥å…·åŒ…</span>
>
> #### å®‰è£…åŒ…ï¼š https://pan.baidu.com/s/1hNC1vSXbkvOGnHNJS0SqaQ?pwd=3tn6 æå–ç : 3tn6
>
> #### ä½¿ç”¨æ–¹æ³•ï¼šæ‹·è´ jar åŒ…åˆ° libs æ–‡ä»¶ç›®å½•ä¸‹ï¼Œå³é”®æ·»åŠ ä¸ºåº“ï¼Œå¯ä»¥å‚è€ƒå‰é¢è·å– mysql-connector-java-5.1.37-bin.jar çš„æ“ä½œ

## éœ€æ±‚åˆ†æ

### åŒ…éœ€æ±‚

#### ï¼ˆ1ï¼‰viewï¼šç”¨æˆ·ç•Œé¢å±‚

#### ï¼ˆ2ï¼‰serviceï¼šä¸šåŠ¡å±‚ï¼Œæ ¸å¿ƒä¸šåŠ¡å®ç°é€»è¾‘éƒ½åœ¨è¿™é‡Œå®ç°

#### ï¼ˆ3ï¼‰daoï¼šå¯¹æ•°æ®åº“è¿›è¡Œ CRUD

#### ï¼ˆ4ï¼‰domainï¼šæ•°æ®åº“è¡¨æ˜ å°„

#### ï¼ˆ5ï¼‰utilsï¼šå·¥å…·ç±»

### ç›¸å…³ç±»

#### ï¼ˆ1ï¼‰å¼•å…¥å·¥å…·ç±»

> #### Utilityï¼šè´Ÿè´£æ¥æ”¶ç”¨æˆ·è¾“å…¥
>
> #### JDBCUtils_Druidï¼šå°è£…äº†ç›¸å…³æ–¹æ³•ï¼Œæ•°æ®åº“çš„è¿æ¥ï¼Œèµ„æºçš„å…³é—­

#### ï¼ˆ2ï¼‰åˆ›å»ºé›‡å‘˜è¡¨

#### ï¼ˆ3ï¼‰åˆ›å»º Employeeï¼ˆdomian ç±»ï¼‰ï¼Œæ•°æ®è¡¨çš„æ˜ å°„

#### ï¼ˆ4ï¼‰Dao

> #### BasicDaoï¼šå°è£…å¥½çš„æ•°æ®åº“ç±»ï¼Œå®ç°åŸºæœ¬æ“ä½œï¼Œå¯¹æ•°æ®åº“çš„ CRUD
>
> #### EmployeeDaoï¼šå…±æœ‰æ–¹æ³•éƒ½æ”¾åœ¨ BasicDao ä¸­ï¼Œç‰¹æœ‰çš„æ–¹æ³•å¯ä»¥åœ¨è‡ªå·±çš„ç±»ä¸­å£°æ˜

## dao åŒ…

### BasicDao

```java
package dao;

import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.handlers.BeanHandler;
import org.apache.commons.dbutils.handlers.BeanListHandler;
import org.apache.commons.dbutils.handlers.ScalarHandler;
import utils.JDBCUtils_Druid;

import java.sql.Connection;
import java.sql.SQLException;
import java.util.List;

public class BasicDao<T> {
    // ä½¿ç”¨ DBUtils å°è£…DAOç±»ï¼Œå®ç°å¯¹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥

    // åˆ›å»º queryRunner å¯¹è±¡
    QueryRunner queryRunner = new QueryRunner();

    // æŸ¥è¯¢å…¨è¡¨
    public List<T> queryTable(String sql, Class<T> clazz, Object... parameters) {
        Connection connection = null;
        try {
            // è·å–è¿æ¥
            connection = JDBCUtils_Druid.getConnection();
            // è¿”å›æŸ¥è¯¢ç»“æœ
            return queryRunner.query(connection, sql, new BeanListHandler<T>(clazz), parameters);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        } finally {
            // å…³é—­èµ„æº
            JDBCUtils_Druid.close(null, connection, null);
        }
    }

    // å•è¡ŒæŸ¥è¯¢
    public T queryLine(String sql, Class<T> clazz, Object... parameters) {
        Connection connection = null;
        try {
            // è·å–è¿æ¥
            connection = JDBCUtils_Druid.getConnection();
            // è¿”å›æŸ¥è¯¢ç»“æœ
            return queryRunner.query(connection, sql, new BeanHandler<T>(clazz), parameters);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        } finally {
            // å…³é—­èµ„æº
            JDBCUtils_Druid.close(null, connection, null);
        }
    }

    // å•è¡Œå•åˆ—æŸ¥è¯¢
    public Object queryValue(String sql, Object... parameters) {
        Connection connection = null;
        try {
            // è·å–è¿æ¥
            connection = JDBCUtils_Druid.getConnection();
            // è¿”å›æŸ¥è¯¢ç»“æœ
            return queryRunner.query(connection, sql, new ScalarHandler(), parameters);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        } finally {
            // å…³é—­èµ„æº
            JDBCUtils_Druid.close(null, connection, null);
        }
    }

    // DMLè¯­å¥
    public int update(String sql, Object... parameters) {
        Connection connection = null;
        try {
            connection = JDBCUtils_Druid.getConnection();
            int rows = queryRunner.update(connection, sql, parameters);
            return rows;
        } catch (SQLException e) {
            throw new RuntimeException(e);
        } finally {
            JDBCUtils_Druid.close(null, connection, null);
        }
    }
}
```

### EmployeeDao

```java
package dao;

import domain.Employee;

public class EmployeeDao extends BasicDao<Employee>{
    // å¦‚æœ‰ç‰¹æ®Šæ–¹æ³•æˆ–è€…éœ€æ±‚å†å†™
}
```

## domain åŒ…

### Employee

```java
package domain;

public class Employee {
    private Integer id;
    private String empId;
    private String pwd;
    private String name;
    private String job;

    // æ— å‚æ„é€ å™¨ï¼Œapache-DBUtilsåå°„éœ€è¦ç”¨
    public Employee(){

    }

    public Employee(Integer id, String empId, String pwd, String name, String job) {
        this.id = id;
        this.empId = empId;
        this.pwd = pwd;
        this.name = name;
        this.job = job;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getEmpId() {
        return empId;
    }

    public void setEmpId(String empId) {
        this.empId = empId;
    }

    public String getPwd() {
        return pwd;
    }

    public void setPwd(String pwd) {
        this.pwd = pwd;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getJob() {
        return job;
    }

    public void setJob(String job) {
        this.job = job;
    }

    @Override
    public String toString() {
        return "Employee{" +
                "id=" + id +
                ", empId='" + empId + '\'' +
                ", pwd='" + pwd + '\'' +
                ", name='" + name + '\'' +
                ", job='" + job + '\'' +
                '}';
    }
}
```

## utils åŒ…

### JDBCUtils_Druid

```java
package utils;

import com.alibaba.druid.pool.DruidDataSourceFactory;

import javax.sql.DataSource;
import java.io.FileInputStream;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Properties;

public class JDBCUtils_Druid { // Druid è¿æ¥æ± 
    private static DataSource dataSource = null;

    // é™æ€ä»£ç å¿«åˆå§‹åŒ–ï¼Œè¯»å–é…ç½®æ–‡ä»¶ä¿¡æ¯
    static {
        Properties properties = new Properties();
        try {
            properties.load(new FileInputStream("src/druid.properties"));
            dataSource = DruidDataSourceFactory.createDataSource(properties);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    // è¿æ¥æ–¹æ³•
    public static Connection getConnection() throws SQLException {
        return dataSource.getConnection();
    }

    // å…³é—­èµ„æº
    public static void close(ResultSet resultSet,Connection connection,Statement statement){
        try {
            if (resultSet != null) {
                resultSet.close();
            }
            if (connection != null) {
                connection.close();
            }
            if (statement != null) {
                statement.close();
            }
        } catch (SQLException e) {
            /*
                å®é™…å¼€å‘ä¸­å¸¸ç”¨ä¸‹é¢çš„æ–¹å¼å¤„ç†
                1. å°†ç¼–è¯‘å¼‚å¸¸è½¬ä¸ºè¿è¡Œå¼‚å¸¸
                2. è°ƒç”¨è€…å¯ä»¥é€‰æ‹©æ•è·è¯¥å¼‚å¸¸ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©é»˜è®¤å¤„ç†è¯¥å¼‚å¸¸ï¼Œæ¯”è¾ƒæ–¹ä¾¿
             */
            throw new RuntimeException(e);
        }
    }
}
```

### Utility

```java
package utils;


/**
	å·¥å…·ç±»çš„ä½œç”¨:
	å¤„ç†å„ç§æƒ…å†µçš„ç”¨æˆ·è¾“å…¥ï¼Œå¹¶ä¸”èƒ½å¤ŸæŒ‰ç…§ç¨‹åºå‘˜çš„éœ€æ±‚ï¼Œå¾—åˆ°ç”¨æˆ·çš„æ§åˆ¶å°è¾“å…¥ã€‚
*/

import java.util.*;
/**


*/
public class Utility {
	//é™æ€å±æ€§ã€‚ã€‚ã€‚
    private static Scanner scanner = new Scanner(System.in);


    /**
     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ä¸€ä¸ªèœå•é€‰é¡¹ï¼Œå€¼ï¼š1â€”â€”5çš„èŒƒå›´
     * @return 1â€”â€”5
     */
	public static char readMenuSelection() {
        char c;
        for (; ; ) {
            String str = readKeyBoard(1, false);//åŒ…å«ä¸€ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²
            c = str.charAt(0);//å°†å­—ç¬¦ä¸²è½¬æ¢æˆå­—ç¬¦charç±»å‹
            if (c != '1' && c != '2' &&
                c != '3' && c != '4' && c != '5') {
                System.out.print("é€‰æ‹©é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š");
            } else {
                break;
            }
        }
        return c;
    }

	/**
	 * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ä¸€ä¸ªå­—ç¬¦
	 * @return ä¸€ä¸ªå­—ç¬¦
	 */
    public static char readChar() {
        String str = readKeyBoard(1, false);//å°±æ˜¯ä¸€ä¸ªå­—ç¬¦
        return str.charAt(0);
    }
    /**
     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚æœç›´æ¥æŒ‰å›è½¦ï¼Œåˆ™è¿”å›æŒ‡å®šçš„é»˜è®¤å€¼ï¼›å¦åˆ™è¿”å›è¾“å…¥çš„é‚£ä¸ªå­—ç¬¦
     * @param defaultValue æŒ‡å®šçš„é»˜è®¤å€¼
     * @return é»˜è®¤å€¼æˆ–è¾“å…¥çš„å­—ç¬¦
     */

    public static char readChar(char defaultValue) {
        String str = readKeyBoard(1, true);//è¦ä¹ˆæ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ªå­—ç¬¦
        return (str.length() == 0) ? defaultValue : str.charAt(0);
    }

    /**
     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„æ•´å‹ï¼Œé•¿åº¦å°äº2ä½
     * @return æ•´æ•°
     */
    public static int readInt() {
        int n;
        for (; ; ) {
            String str = readKeyBoard(2, false);//ä¸€ä¸ªæ•´æ•°ï¼Œé•¿åº¦<=2ä½
            try {
                n = Integer.parseInt(str);//å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°
                break;
            } catch (NumberFormatException e) {
                System.out.print("æ•°å­—è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š");
            }
        }
        return n;
    }
    /**
     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ æ•´æ•°æˆ–é»˜è®¤å€¼ï¼Œå¦‚æœç›´æ¥å›è½¦ï¼Œåˆ™è¿”å›é»˜è®¤å€¼ï¼Œå¦åˆ™è¿”å›è¾“å…¥çš„æ•´æ•°
     * @param defaultValue æŒ‡å®šçš„é»˜è®¤å€¼
     * @return æ•´æ•°æˆ–é»˜è®¤å€¼
     */
    public static int readInt(int defaultValue) {
        int n;
        for (; ; ) {
            String str = readKeyBoard(10, true);
            if (str.equals("")) {
                return defaultValue;
            }

			//å¼‚å¸¸å¤„ç†...
            try {
                n = Integer.parseInt(str);
                break;
            } catch (NumberFormatException e) {
                System.out.print("æ•°å­—è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š");
            }
        }
        return n;
    }

    /**
     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²
     * @param limit é™åˆ¶çš„é•¿åº¦
     * @return æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²
     */

    public static String readString(int limit) {
        return readKeyBoard(limit, false);
    }

    /**
     * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²æˆ–é»˜è®¤å€¼ï¼Œå¦‚æœç›´æ¥å›è½¦ï¼Œè¿”å›é»˜è®¤å€¼ï¼Œå¦åˆ™è¿”å›å­—ç¬¦ä¸²
     * @param limit é™åˆ¶çš„é•¿åº¦
     * @param defaultValue æŒ‡å®šçš„é»˜è®¤å€¼
     * @return æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²
     */

    public static String readString(int limit, String defaultValue) {
        String str = readKeyBoard(limit, true);
        return str.equals("")? defaultValue : str;
    }


	/**
	 * åŠŸèƒ½ï¼šè¯»å–é”®ç›˜è¾“å…¥çš„ç¡®è®¤é€‰é¡¹ï¼ŒYæˆ–N
	 * å°†å°çš„åŠŸèƒ½ï¼Œå°è£…åˆ°ä¸€ä¸ªæ–¹æ³•ä¸­.
	 * @return Yæˆ–N
	 */
    public static char readConfirmSelection() {
        System.out.println("è¯·è¾“å…¥ä½ çš„é€‰æ‹©(Y/N)");
        char c;
        for (; ; ) {//æ— é™å¾ªç¯
        	//åœ¨è¿™é‡Œï¼Œå°†æ¥å—åˆ°å­—ç¬¦ï¼Œè½¬æˆäº†å¤§å†™å­—æ¯
        	//y => Y n=>N
            String str = readKeyBoard(1, false).toUpperCase();
            c = str.charAt(0);
            if (c == 'Y' || c == 'N') {
                break;
            } else {
                System.out.print("é€‰æ‹©é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š");
            }
        }
        return c;
    }

    /**
     * åŠŸèƒ½ï¼š è¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²
     * @param limit è¯»å–çš„é•¿åº¦
     * @param blankReturn å¦‚æœä¸ºtrue ,è¡¨ç¤º å¯ä»¥è¯»ç©ºå­—ç¬¦ä¸²ã€‚
     * 					  å¦‚æœä¸ºfalseè¡¨ç¤º ä¸èƒ½è¯»ç©ºå­—ç¬¦ä¸²ã€‚
     *
	 *	å¦‚æœè¾“å…¥ä¸ºç©ºï¼Œæˆ–è€…è¾“å…¥å¤§äºlimitçš„é•¿åº¦ï¼Œå°±ä¼šæç¤ºé‡æ–°è¾“å…¥ã€‚
     * @return
     */
    private static String readKeyBoard(int limit, boolean blankReturn) {

		//å®šä¹‰äº†å­—ç¬¦ä¸²
		String line = "";

		//scanner.hasNextLine() åˆ¤æ–­æœ‰æ²¡æœ‰ä¸‹ä¸€è¡Œ
        while (scanner.hasNextLine()) {
            line = scanner.nextLine();//è¯»å–è¿™ä¸€è¡Œ

			//å¦‚æœline.length=0, å³ç”¨æˆ·æ²¡æœ‰è¾“å…¥ä»»ä½•å†…å®¹ï¼Œç›´æ¥å›è½¦
			if (line.length() == 0) {
                if (blankReturn) {
                    return line;//å¦‚æœblankReturn=true,å¯ä»¥è¿”å›ç©ºä¸²
                } else {
                    continue; //å¦‚æœblankReturn=false,ä¸æ¥å—ç©ºä¸²ï¼Œå¿…é¡»è¾“å…¥å†…å®¹
                }
            }

			//å¦‚æœç”¨æˆ·è¾“å…¥çš„å†…å®¹å¤§äºäº† limitï¼Œå°±æç¤ºé‡å†™è¾“å…¥
			//å¦‚æœç”¨æˆ·å¦‚çš„å†…å®¹ >0 <= limit ,æˆ‘å°±æ¥å—
            if (line.length() < 1 || line.length() > limit) {
                System.out.print("è¾“å…¥é•¿åº¦ï¼ˆä¸èƒ½å¤§äº" + limit + "ï¼‰é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š");
                continue;
            }
            break;
        }

        return line;
    }
}
```

## druid é…ç½®æ–‡ä»¶

```bash
#key=value
driverClassName=com.mysql.jdbc.Driver
#url=jdbc:mysql://localhost:3306/jdbc
url=jdbc:mysql://localhost:3306/manhanlou?rewriteBatchedStatements=true
username=root
password=
#initial connection Size
initialSize=10
#min idle connecton size
minIdle=5
#max active connection size
maxActive=20
#max wait time (5000 mil seconds)
maxWait=5000
```

## åˆ›å»º employee è¡¨

```sql
CREATE DATABASE ManHanLou;
CREATE TABLE employee (
  id INT PRIMARY KEY AUTO_INCREMENT,             -- è‡ªå¢ä¸»é”®
  empId VARCHAR(50) UNIQUE NOT NULL DEFAULT '',  -- å‘˜å·¥å·ï¼Œå”¯ä¸€ä¸”éç©º
  pwd CHAR(32) NOT NULL DEFAULT '',              -- å¯†ç ï¼ˆMD5åŠ å¯†ï¼‰
  NAME VARCHAR(50) NOT NULL DEFAULT '',          -- å§“å
  job VARCHAR(50) NOT NULL DEFAULT ''            -- å²—ä½
) DEFAULT CHARSET=utf8;


INSERT INTO employee VALUES(NULL, '6668612', MD5('123456'), 'å¼ ä¸‰ä¸°', 'ç»ç†');
INSERT INTO employee VALUES(NULL, '6668622', MD5('123456'), 'å°é¾™å¥³', 'æœåŠ¡å‘˜');
INSERT INTO employee VALUES(NULL, '6668633', MD5('123456'), 'å¼ æ— å¿Œ', 'æ”¶é“¶å‘˜');
INSERT INTO employee VALUES(NULL, '666666',  MD5('123456'), 'è€éŸ©',   'ç»ç†');
```

## æµ‹è¯•ç±» test

```java
package utils;

import dao.EmployeeDao;
import domain.Employee;

import java.sql.Connection;
import java.sql.SQLException;
import java.util.List;

public class test {
    public static void main(String[] args) throws SQLException {
        // æµ‹è¯•è¿æ¥
        Connection connection = JDBCUtils_Druid.getConnection();
        System.out.println(connection);
        // DQLè¯­å¥æµ‹è¯•
        EmployeeDao employeeDao = new EmployeeDao();
        String sql = "select * from employee";
        List<Employee> employees = employeeDao.queryTable(sql, Employee.class);
        for (Employee employee :employees) {
            System.out.println(employee.getEmpId() + "\t" + employee.getName() + "\t" + employee.getJob()
            + "\t" + employee.getPwd());
        }
    }
}
```

#### è¾“å‡ºç»“æœ

```java
com.mysql.jdbc.JDBC4Connection@5f150435
6668612	å¼ ä¸‰ä¸°	ç»ç†	e10adc3949ba59abbe56e057f20f883e
6668622	å°é¾™å¥³	æœåŠ¡å‘˜	e10adc3949ba59abbe56e057f20f883e
6668633	å¼ æ— å¿Œ	æ”¶é“¶å‘˜	e10adc3949ba59abbe56e057f20f883e
666666	è€éŸ©	ç»ç†	e10adc3949ba59abbe56e057f20f883e
```

<br/>

::: tip &nbsp;

<h1 style="text-align:center;padding-bottom:30px">ğŸ‰ğŸ‰æˆåŠŸå®ç°ï¼Œå®Œç»“æ•£èŠ±ğŸ‰ğŸ‰</h1>
:::
